"use strict";class MdApi{baseUrl;lang;instId;async fetchJsonApi(e){e.searchParams.set("navlang",this.lang);const t=await fetch(e,{method:"GET",headers:{"X-VIA":"md api client; "+location.hostname}});if(!t.ok){const e=`An error has occured: ${t.status}`;throw new Error(e)}const n=await t.json();return Object.freeze(n),n}async getObject(e){const n=new URL(this.baseUrl+"/json/object/"+encodeURIComponent(e)),t=await this.fetchJsonApi(n);if(this.instId!==null&&t.object_institution.institution_id!==this.instId)throw"This object does not belong to the selected institution";return t}_getObjectSearchUrl(e,t,n=24,s=0){const o=new URL(this.baseUrl+e);if(typeof t=="object"?(o.searchParams.set("s",t.s),t.extend!==""&&o.searchParams.set("extendQuery",t.extend)):t.includes(":")?o.searchParams.set("s",t):o.searchParams.set("extendQuery",t),this.instId!==null&&o.searchParams.set("instnr",this.instId),s!==0&&o.searchParams.set("startwert",s),n>100)throw"You were trying to query more than the maximum 100 objects at a time";return o.searchParams.set("gbreitenat",n),o}async searchObjects(e,t=24,n=0){const s=this._getObjectSearchUrl("/json/objects",e,t,n),o=await this.fetchJsonApi(s);return o}async getObjectQueryStrings(e){const t=this._getObjectSearchUrl("/json/objects_get_query_string",e),n=await this.fetchJsonApi(t);return n.results}async getObjectsFacetSearchOptions(e){let t;typeof e=="object"||e.includes(":")===!1&&e!==""?t=await this.getObjectQueryStrings(e):(t=e,this.instId!==null&&(t+=" institution:"+this.instId));const n=new URL(this.baseUrl+"/json/object-facet-search/"+encodeURIComponent(t)),s=await this.fetchJsonApi(n);return s}async getObjectsFacetSearchOptionsFlat(e,t=20){const s=await this.getObjectsFacetSearchOptions(e),n=[];for(const e in s){if(this.instId!==null&&e==="institution")continue;for(const t of s[e])t.type=e,n.push(t)}n.sort((e,t)=>t.count-e.count);const o=n.slice(0,t);return o.sort((e,t)=>(""+e.name).localeCompare(t.name)),o}async getObjectsLinkedEntities(e){const t=new URL(this.baseUrl+"/json/search-linked-entries-by-name/"+encodeURIComponent(e)),n=await this.fetchJsonApi(t);return n}async getInstitution(e){const t=new URL(this.baseUrl+"/json/institution/"+encodeURIComponent(e)),n=await this.fetchJsonApi(t);return n}async listCollectionsByInst(e){const t=new URL(this.baseUrl+"/json/collections_by_institution/"+encodeURIComponent(e)),n=await this.fetchJsonApi(t);return n}async searchCollections(e,t=100,n=0){if(this.instId!==null)throw"You set an institution ID. Please use listCollectionsByInst()";const s=new URL(this.baseUrl+"/json/collections_by_institutions");s.searchParams.set("q",e),s.searchParams.set("limit",t),s.searchParams.set("offset",n);const o=await this.fetchJsonApi(s);return o}async getCollection(e){const t=new URL(this.baseUrl+"/json/collection/"+encodeURIComponent(e)),n=await this.fetchJsonApi(t);return n}async getSeries(e){const t=new URL(this.baseUrl+"/json/series/"+encodeURIComponent(e)),n=await this.fetchJsonApi(t);return n}async searchExhibition(e,t="start",n="DESC"){const s=new URL(this.baseUrl+"/json/list_exhibitions");this.instId!==null&&s.searchParams.set("institution_id",this.instId),e.start_before!==void 0&&e.start_before!==null&&s.searchParams.set("start_before",e.start_before.toString()),e.start_after!==void 0&&e.start_after!==null&&s.searchParams.set("start_after",e.start_after.toString()),e.end_before!==void 0&&e.end_before!==null&&s.searchParams.set("end_before",e.end_before.toString()),e.end_after!==void 0&&e.end_after!==null&&s.searchParams.set("end_after",e.end_after.toString()),e.permanent!==void 0&&e.permanent!==null&&s.searchParams.set("permanent",e.permanent),e.place!==void 0&&e.place!==null&&s.searchParams.set("place",e.place),s.searchParams.set("sort_by",t),s.searchParams.set("sort_order",n);const o=await this.fetchJsonApi(s);return o}async getExhibition(e){const t=new URL(this.baseUrl+"/json/exhibition/"+encodeURIComponent(e)),n=await this.fetchJsonApi(t);return n}async searchEvents(e,t="start",n="DESC"){const s=new URL(this.baseUrl+"/json/list_exhibitions");this.instId!==null&&s.searchParams.set("institution_id",this.instId),e.start_before!==void 0&&e.start_before!==null&&s.searchParams.set("start_before",e.start_before.toString()),e.start_after!==void 0&&e.start_after!==null&&s.searchParams.set("start_after",e.start_after.toString()),e.end_before!==void 0&&e.end_before!==null&&s.searchParams.set("end_before",e.end_before.toString()),e.end_after!==void 0&&e.end_after!==null&&s.searchParams.set("end_after",e.end_after.toString()),e.place!==void 0&&e.place!==null&&s.searchParams.set("place",e.place),s.searchParams.set("sort_by",t),s.searchParams.set("sort_order",n);const o=await this.fetchJsonApi(s);return o}async getEvent(e){const t=new URL(this.baseUrl+"/json/event/"+encodeURIComponent(e)),n=await this.fetchJsonApi(t);return n}setInstitutionId(e){this.instId=e}constructor(e,t){this.baseUrl=e,this.lang=t,this.instId=null}}